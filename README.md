# MathVideo: è‡ªåŠ¨åŒ–æ•°å­¦è§†é¢‘ç”Ÿæˆå™¨

ä¸€ä¸ªåˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ (Claude) å’Œ Manim è‡ªåŠ¨ç”Ÿæˆæ•°å­¦è®²è§£è§†é¢‘çš„ç«¯åˆ°ç«¯ç³»ç»Ÿã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ¤– æ™ºèƒ½è§„åˆ’**: ä½¿ç”¨ LLM è‡ªåŠ¨å°†æ•°å­¦ä¸»é¢˜æ‹†è§£ä¸ºç»“æ„åŒ–çš„åˆ†é•œè„šæœ¬
- **ğŸ¬ ä»£ç ç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆ Manim Python åŠ¨ç”»ä»£ç 
- **ğŸ”§ è‡ªåŠ¨ä¿®å¤**: æ¸²æŸ“å¤±è´¥æ—¶è‡ªåŠ¨åˆ†æé”™è¯¯å¹¶ä¿®å¤ä»£ç 
- **ğŸ‘ï¸ è§†è§‰åé¦ˆ**: ä½¿ç”¨è§†è§‰å¤§æ¨¡å‹ (Gemini 3 Pro) åˆ†æç”Ÿæˆçš„è§†é¢‘å¸§ï¼Œæ£€æµ‹å¸ƒå±€é—®é¢˜
- **âœ¨ æ™ºèƒ½ä¼˜åŒ–**: æ ¹æ®è§†è§‰åé¦ˆè‡ªåŠ¨ä¼˜åŒ–ä»£ç ï¼Œæå‡è§†é¢‘è´¨é‡
- **ğŸ–¼ï¸ èµ„äº§ç®¡ç†**: è‡ªåŠ¨è¯†åˆ«å¹¶ä¸‹è½½/ç”Ÿæˆæ‰€éœ€çš„å›¾æ ‡èµ„æº

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- [Anaconda](https://www.anaconda.com/products/distribution) æˆ– [Miniconda](https://docs.conda.io/en/latest/miniconda.html)
- [FFmpeg](https://ffmpeg.org/) (Manim å¿…éœ€)
- **LaTeX** (æ•°å­¦å…¬å¼æ¸²æŸ“å¿…éœ€)
    - **MacOS**: `brew install --cask mactex` æˆ–å®‰è£… [MacTeX](https://www.tug.org/mactex/)
    - **Linux**: `sudo apt-get install texlive-full`
    - **Windows**: å®‰è£… [MiKTeX](https://miktex.org/)

> **å…³äº LaTeX**: ç³»ç»Ÿå†…ç½®äº† LaTeX å›é€€æœºåˆ¶ï¼Œå³ä½¿æœªå®‰è£… LaTeX ä¹Ÿèƒ½è¿è¡Œï¼ˆä½¿ç”¨ Text æ›¿ä»£ MathTexï¼‰ï¼Œä½†ä¸ºè·å¾—æœ€ä½³æ•°å­¦å…¬å¼æ•ˆæœï¼Œå»ºè®®å®‰è£…å®Œæ•´çš„ LaTeX å‘è¡Œç‰ˆã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»º Conda ç¯å¢ƒ

```bash
conda create -n mathvideo python=3.10 -y
conda activate mathvideo
```

### 2. å®‰è£… Manim (æ¨èä½¿ç”¨ conda-forge)

```bash
conda install -c conda-forge manim ffmpeg -y
```

### 3. å®‰è£… Python ä¾èµ–

```bash
pip install -r requirements.txt
```

### 4. é…ç½® API å¯†é’¥

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å…¥å¯†é’¥ï¼š

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶å¡«å…¥ API å¯†é’¥
```

```dotenv
# å¿…å¡«: Claude API (ç”¨äºè§„åˆ’/ä»£ç ç”Ÿæˆ)
CLAUDE_API_KEY=sk-ant-your-key-here
CLAUDE_MODEL_NAME=claude-opus-4-5-20251101

# å¯é€‰: Gemini API (ç”¨äºè§†è§‰åé¦ˆ)
GEMINI_API_KEY=AIza-your-key-here
GEMINI_VISION_MODEL_NAME=gemini-3-pro-preview
```

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# ç”Ÿæˆå¹¶æ¸²æŸ“è§†é¢‘ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰
python -m mathvideo "è¯·è§£é‡Šå‹¾è‚¡å®šç†çš„è¯æ˜æ€è·¯" --render

# ä»…ç”Ÿæˆè„šæœ¬ï¼Œä¸æ¸²æŸ“ï¼ˆæè¿°/é—®é¢˜ï¼‰
python -m mathvideo "å·²çŸ¥åœ†çš„åŠå¾„ä¸º rï¼Œè§£é‡Šåœ†é¢ç§¯å…¬å¼çš„æ¥æº"

# å¤šæ¨¡æ€è¾“å…¥ï¼ˆæ–‡æœ¬ + å›¾ç‰‡ï¼‰
python -m mathvideo "è¿™å¼ å›¾é‡Œçš„ä¸‰è§’å½¢é¢ç§¯å¦‚ä½•è®¡ç®—ï¼Ÿ" --image /path/to/triangle.png --render
```

å…¼å®¹æ—§å…¥å£ï¼ˆä»å¯ç”¨ï¼‰ï¼š

```bash
python main.py "å‹¾è‚¡å®šç†" --render
```

### Web ç•Œé¢

é¡¹ç›®æä¾›äº† Web ç•Œé¢ï¼Œæ”¯æŒå®æ—¶æ—¥å¿—å’Œå¯è§†åŒ–æ“ä½œï¼š

```bash
# ç»ˆç«¯ 1 - å¯åŠ¨åç«¯ (ç«¯å£ 8000)
conda run -n mathvideo python -m uvicorn backend.main:app --host 0.0.0.0 --port 8000

# ç»ˆç«¯ 2 - å¯åŠ¨å‰ç«¯ (ç«¯å£ 3000)
cd frontend && npm install && npm run dev
```

è®¿é—® http://localhost:3000 ä½¿ç”¨ Web ç•Œé¢ã€‚API æ–‡æ¡£: http://localhost:8000/docs

### è¾“å‡ºç»“æ„

```
output/
  å‹¾è‚¡å®šç†/
    storyboard.json       # åˆ†é•œè„šæœ¬ (JSON)
    assets/               # ä¸‹è½½/ç”Ÿæˆçš„å›¾æ ‡èµ„æº
      triangle.svg
      square.svg
    scripts/              # ç”Ÿæˆçš„ Manim Python è„šæœ¬
      section_1.py
      section_2.py
      ...
    media/                # æ¸²æŸ“è¾“å‡º
      videos/
        section_1/
          480p15/
            frames/       # è§†è§‰åˆ†æç”¨çš„å…³é”®å¸§
            Section1Scene.mp4
```

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¨¡å—

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| **Planner** | `mathvideo/agents/planner.py` | å°†ä¸»é¢˜è½¬æ¢ä¸ºåˆ†é•œè„šæœ¬ |
| **Coder** | `mathvideo/agents/coder.py` | ç”Ÿæˆ Manim ä»£ç  |
| **Fixer** | `mathvideo/agents/coder.py` | ä¿®å¤è¿è¡Œé”™è¯¯ |
| **Refiner** | `mathvideo/agents/coder.py` | æ ¹æ®è§†è§‰åé¦ˆä¼˜åŒ–ä»£ç  |
| **Critic** | `mathvideo/agents/critic.py` | è§†è§‰è´¨é‡åˆ†æ |
| **AssetManager** | `mathvideo/agents/asset_manager.py` | èµ„äº§ä¸‹è½½/ç”Ÿæˆ |
| **TeachingScene** | `mathvideo/manim_base.py` | Manim åŸºç¡€ç±»å’Œç½‘æ ¼ç³»ç»Ÿ |

### å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           MathVideo ç”Ÿæˆæµç¨‹                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [è¾“å…¥]                                                                      â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â–¼                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   Planner   â”‚â”€â”€â”€â–¶â”‚AssetManager â”‚â”€â”€â”€â–¶â”‚    Coder    â”‚                      â”‚
â”‚  â”‚ (åˆ†é•œè§„åˆ’)   â”‚    â”‚ (èµ„äº§å‡†å¤‡)   â”‚    â”‚ (ä»£ç ç”Ÿæˆ)  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                               â”‚                             â”‚
â”‚                                               â–¼                             â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                                        â”‚   Manim    â”‚                      â”‚
â”‚                                        â”‚  (æ¸²æŸ“)    â”‚                      â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                               â”‚                             â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚                              â”‚                â”‚                â”‚            â”‚
â”‚                              â–¼                â–¼                â–¼            â”‚
â”‚                         [æˆåŠŸ]           [å¤±è´¥]          [æˆåŠŸ]            â”‚
â”‚                           â”‚                â”‚                â”‚              â”‚
â”‚                           â”‚                â–¼                â–¼              â”‚
â”‚                           â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                           â”‚         â”‚   Fixer    â”‚  â”‚   Critic   â”‚       â”‚
â”‚                           â”‚         â”‚ (é”™è¯¯ä¿®å¤)  â”‚  â”‚ (è§†è§‰åˆ†æ)  â”‚       â”‚
â”‚                           â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                           â”‚                â”‚                â”‚              â”‚
â”‚                           â”‚                â–¼                â–¼              â”‚
â”‚                           â”‚           [é‡æ–°æ¸²æŸ“]      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                           â”‚                â”‚         â”‚  Refiner   â”‚       â”‚
â”‚                           â”‚                â”‚         â”‚ (ä»£ç ä¼˜åŒ–)  â”‚       â”‚
â”‚                           â”‚                â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                           â”‚                â”‚                â”‚              â”‚
â”‚                           â”‚                â”‚                â–¼              â”‚
â”‚                           â”‚                â”‚           [é‡æ–°æ¸²æŸ“]          â”‚
â”‚                           â”‚                â”‚                â”‚              â”‚
â”‚                           â–¼                â–¼                â–¼              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                        â”‚            è¾“å‡ºè§†é¢‘                  â”‚             â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ TeachingScene ç½‘æ ¼ç³»ç»Ÿ

æ‰€æœ‰ç”Ÿæˆçš„è§†é¢‘ä½¿ç”¨ç»Ÿä¸€çš„å¸ƒå±€æ¡†æ¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ‡é¢˜                          â”‚                               â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚  A1  A2  A3  ...  A10        â”‚
â”‚ è®²ä¹‰ç¬”è®° 1                     â”‚  B1  B2  B3  ...  B10        â”‚
â”‚ è®²ä¹‰ç¬”è®° 2                     â”‚  C1  C2  C3  ...  C10        â”‚
â”‚ è®²ä¹‰ç¬”è®° 3                     â”‚  ...                         â”‚
â”‚ ...                           â”‚  J1  J2  J3  ...  J10        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        å·¦ä¾§ (è®²ä¹‰åŒº)                    å³ä¾§ (åŠ¨ç”»åŒº 10x10 ç½‘æ ¼)
```

### å®šä½æ–¹æ³•

```python
# å•ç‚¹å®šä½
self.place_at_grid(circle, 'E5', scale_factor=0.8)

# åŒºåŸŸå®šä½ (æ¨èç”¨äºå‡ ä½•å›¾å½¢)
self.place_in_area(triangle, 'B2', 'H8', scale_factor=0.9)

# å‡ ä½•æ ‡ç­¾è¾…åŠ©æ–¹æ³•
label = self.add_side_label(polygon, side_index=0, "a", color=BLUE)
label = self.add_vertex_label(polygon, vertex_index=0, "A")
mark = self.add_right_angle_mark(polygon, vertex_index=1)
```

## ğŸ”§ é…ç½®é€‰é¡¹

åœ¨ `mathvideo/config.py` ä¸­å¯é…ç½®ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `USE_VISUAL_FEEDBACK` | å¯ç”¨è§†è§‰åé¦ˆä¼˜åŒ– | `True` |
| `CLAUDE_API_KEY` | Claude API å¯†é’¥ | å¿…å¡« |
| `CLAUDE_MODEL_NAME` | Claude æ¨¡å‹åç§° | `claude-opus-4-5-20251101` |
| `GEMINI_API_KEY` | Gemini API å¯†é’¥ | å¯é€‰ |
| `GEMINI_VISION_MODEL_NAME` | Gemini è§†è§‰æ¨¡å‹åç§° | `gemini-3-pro-preview` |
| `ICONFINDER_API_KEY` | IconFinder API å¯†é’¥ | å¯é€‰ |

## ğŸŒ Web æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js å‰ç«¯   â”‚â—„â”€â”€â”€â”€â–ºâ”‚  FastAPI åç«¯    â”‚
â”‚   (ç«¯å£ 3000)    â”‚ API  â”‚   (ç«¯å£ 8000)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  mathvideo æ ¸å¿ƒ  â”‚
                         â”‚   (CLI æ¨¡å—)     â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **WebSocket å®æ—¶æ—¥å¿—**: `ws://localhost:8000/api/generate/ws/{task_id}`
- **é™æ€æ–‡ä»¶æœåŠ¡**: åç«¯æŒ‚è½½ `output/` ä¸º `/static/`
- **å‰ç«¯ä»£ç†**: Next.js ä»£ç† `/api/*` åˆ°åç«¯

## ğŸ“„ License

MIT License
